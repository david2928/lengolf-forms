<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LENGOLF Invoice Generator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>LENGOLF Invoice Generator</h1>
        
        <div class="form-container">
            <h2>Service Supplier Details</h2>
            <div class="form-group">
                <label for="csvFile">Suppliers CSV File:</label>
                <input type="file" id="csvFile" accept=".csv" onchange="loadSuppliersFromCSV()">
                <p class="help-text">CSV Format: Name,ID,Address,Bank,Account</p>
            </div>
            
            <div class="form-group">
                <label for="supplierSelect">Select Supplier:</label>
                <select id="supplierSelect" onchange="loadSupplierDetails()">
                    <option value="">-- Select Supplier --</option>
                </select>
            </div>
            
            <div id="supplierDetails">
                <div class="form-group">
                    <label for="supplierName">Supplier Name:</label>
                    <input type="text" id="supplierName" required readonly>
                </div>
                <div class="form-group">
                    <label for="supplierId">ID Number:</label>
                    <input type="text" id="supplierId" required readonly>
                </div>
                <div class="form-group">
                    <label for="supplierAddress">Address:</label>
                    <textarea id="supplierAddress" rows="3" required readonly></textarea>
                </div>
                <div class="form-group">
                    <label for="supplierBank">Bank:</label>
                    <input type="text" id="supplierBank" readonly>
                </div>
                <div class="form-group">
                    <label for="supplierAccount">Account Number:</label>
                    <input type="text" id="supplierAccount" readonly>
                </div>
            </div>
            
            <h2>Invoice Details</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="invoiceNumber">Invoice #:</label>
                    <input type="text" id="invoiceNumber" required>
                </div>
                <div class="form-group">
                    <label for="invoiceDate">Date:</label>
                    <input type="date" id="invoiceDate" required>
                </div>
            </div>
            
            <h2>Service Items</h2>
            <table id="invoiceItems">
                <thead>
                    <tr>
                        <th>Description</th>
                        <th>QTY</th>
                        <th>Unit Price</th>
                        <th>Amount</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" class="item-description" placeholder="Description"></td>
                        <td><input type="number" class="item-qty" value="1" min="1"></td>
                        <td><input type="number" class="item-price" value="0" step="0.01"></td>
                        <td><span class="item-amount">0.00</span></td>
                        <td><button type="button" class="remove-item" onclick="removeItem(this)">Remove</button></td>
                    </tr>
                </tbody>
            </table>
            <button type="button" id="addItem" onclick="addItem()">Add Item</button>
            
            <div class="totals-section">
                <div class="totals-row">
                    <label>Subtotal:</label>
                    <span id="subtotal">0.00</span>
                </div>
                <div class="totals-row">
                    <label>Tax Rate (%):</label>
                    <input type="number" id="taxRate" value="3.00" step="0.01">
                </div>
                <div class="totals-row">
                    <label>Tax:</label>
                    <span id="taxAmount">0.00</span>
                </div>
                <div class="totals-row total">
                    <label>TOTAL:</label>
                    <span id="total">0.00</span>
                </div>
            </div>
            
            <div class="actions">
                <button type="button" id="generatePdf" onclick="generatePDF()">Generate PDF</button>
            </div>
        </div>
    </div>

    <div id="pdfPreview" class="invoice-preview">
        <div class="invoice-container" style="background: white; width: 210mm; padding: 20mm; font-family: Arial, Helvetica, sans-serif; color: #000;">
            <div class="invoice-header" style="display: flex; justify-content: space-between; margin-bottom: 30px;">
                <div class="supplier-info" style="width: 60%;">
                    <h2 id="preview-supplierName" style="color: #2964a0; font-size: 24px; margin-bottom: 10px;"></h2>
                    <p id="preview-supplierId" style="margin-bottom: 5px; font-size: 14px;"></p>
                    <p id="preview-supplierAddress" style="margin-bottom: 5px; font-size: 14px;"></p>
                </div>
                <div class="invoice-title" style="text-align: right; width: 40%;">
                    <h1 style="color: #2964a0; font-size: 36px; margin: 0;">INVOICE</h1>
                </div>
            </div>
            
            <table class="invoice-meta" style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                <thead>
                    <tr>
                        <th style="background-color: #2964a0; color: white; text-align: center; padding: 8px; border: 1px solid #ddd;">INVOICE #</th>
                        <th style="background-color: #2964a0; color: white; text-align: center; padding: 8px; border: 1px solid #ddd;">DATE</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td id="preview-invoiceNumber" style="text-align: center; border: 1px solid #ddd; padding: 8px;"></td>
                        <td id="preview-invoiceDate" style="text-align: center; border: 1px solid #ddd; padding: 8px;"></td>
                    </tr>
                </tbody>
            </table>
            
            <div class="bill-to" style="margin-bottom: 20px;">
                <h3 style="background-color: #2964a0; color: white; padding: 8px; margin-bottom: 10px;">BILL TO</h3>
                <p style="margin-bottom: 5px; padding-left: 5px;">LENGOLF CO. LTD.</p>
                <p style="margin-bottom: 5px; padding-left: 5px;">105566207013</p>
                <p style="margin-bottom: 5px; padding-left: 5px;">540 Mercury Tower, 4 Floor, Unit 407 Ploenchit Road</p>
                <p style="margin-bottom: 5px; padding-left: 5px;">Lumpini, Pathumwan, Bangkok 10330</p>
            </div>
            
            <table class="invoice-items" style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                <thead>
                    <tr>
                        <th style="background-color: #2964a0; color: white; padding: 8px; text-align: left; border: 1px solid #ddd;">DESCRIPTION</th>
                        <th style="background-color: #2964a0; color: white; padding: 8px; text-align: center; border: 1px solid #ddd;">QTY</th>
                        <th style="background-color: #2964a0; color: white; padding: 8px; text-align: right; border: 1px solid #ddd;">UNIT PRICE</th>
                        <th style="background-color: #2964a0; color: white; padding: 8px; text-align: right; border: 1px solid #ddd;">AMOUNT</th>
                    </tr>
                </thead>
                <tbody id="preview-items">
                    <!-- Items will be added here dynamically -->
                </tbody>
            </table>
            
            <p class="thank-you" style="text-align: center; font-style: italic; margin: 20px 0;">Thank you for your business!</p>
            
            <div class="invoice-summary" style="display: flex; justify-content: space-between; align-items: flex-start;">
                <table class="invoice-totals" style="width: 250px; border-collapse: collapse; margin-left: auto;">
                    <tr>
                        <td style="padding: 5px 10px; border: 1px solid #eee; font-weight: 600;">SUBTOTAL</td>
                        <td id="preview-subtotal" style="padding: 5px 10px; border: 1px solid #eee; text-align: right;"></td>
                    </tr>
                    <tr>
                        <td style="padding: 5px 10px; border: 1px solid #eee; font-weight: 600;">TAX RATE</td>
                        <td id="preview-taxRate" style="padding: 5px 10px; border: 1px solid #eee; text-align: right;"></td>
                    </tr>
                    <tr>
                        <td style="padding: 5px 10px; border: 1px solid #eee; font-weight: 600;">TAX</td>
                        <td id="preview-taxAmount" style="padding: 5px 10px; border: 1px solid #eee; text-align: right;"></td>
                    </tr>
                    <tr class="total" style="background-color: #f0f0f0; font-weight: bold;">
                        <td style="padding: 5px 10px; border: 1px solid #eee; font-weight: 600;">TOTAL</td>
                        <td style="padding: 5px 10px; border: 1px solid #eee; text-align: right;">THB <span id="preview-total"></span></td>
                    </tr>
                </table>
                
                <div class="bank-details" id="bank-details-section" style="margin-top: 20px; font-size: 12px;">
                    <div class="bank-row" style="margin-bottom: 5px;">
                        <label style="display: inline-block; min-width: 80px; font-weight: bold;">Bank:</label>
                        <span id="preview-bank"></span>
                    </div>
                    <div class="bank-row" style="margin-bottom: 5px;">
                        <label style="display: inline-block; min-width: 80px; font-weight: bold;">Account:</label>
                        <span id="preview-account"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html> 